<Project>
  <Import Project="$(MSBuildThisFileDirectory)../Directory.Build.targets"/>
  <Import
    Project="$(MSBuildThisFileDirectory)Reqnroll.GeneratorPlugin.Sdk.props"
    Condition="'$(IsReqnrollGeneratorPlugin)' == 'true'"/>
  <Import 
    Project="$(MSBuildThisFileDirectory)Reqnroll.TestFrameworkAdapter.Sdk.props"
    Condition="'$(IsReqnrollTestFrameworkAdapter)' == 'true'"/>
  <Import
    Project="$(MSBuildThisFileDirectory)Reqnroll.TestFrameworkAdapter.Sdk.targets"
    Condition="'$(IsReqnrollTestFrameworkAdapter)' == 'true'"/>
  
  <PropertyGroup>
    <UseCompatibilityRangeForReqnrollDependency Condition="'$(UseCompatibilityRangeForReqnrollDependency)' == ''">true</UseCompatibilityRangeForReqnrollDependency>
  </PropertyGroup>

  <!-- Updates project reference versions to use the explicit override for packing -->
  <Target
    Name="_SetReqnrollProjectReferenceVersionForPack"
    AfterTargets="_GetProjectReferenceVersions"
    Condition="'$(UseCompatibilityRangeForReqnrollDependency)' == 'true'">
    <ItemGroup>
      <_ProjectReferencesWithVersions
        Update="$(MSBuildThisFileDirectory)../Reqnroll/Reqnroll.csproj"
        ProjectVersion="@(_ProjectReferencesWithVersions->'[%(ProjectVersion),$(CompatibilityVersionUpperRange))')"/>
    </ItemGroup>
  </Target>
</Project>
